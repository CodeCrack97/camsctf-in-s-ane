#include <stdio.h>
#include <stdlib.h>

/**
 * This is the output of xxd -i assemble
 * Essentially, the creators of this problem extracted the instruction set from
 * their binary and gave us that. So it's basically shellcode. How do we execute
 * shellcode? Look below.
 * Also since they specify to return a decimal, we make the function pointer an
 * int so that it gives the proper output
 */
unsigned char assemble[] = {
    0x55, 0x48, 0x89, 0xe5, 0xc7, 0x45, 0xf4, 0x63, 0xe7, 0xba, 0x17, 0xc7,
    0x45, 0xf8, 0x6b, 0x71, 0xc4, 0x0f, 0xc7, 0x45, 0xfc, 0xab, 0xef, 0x81,
    0x04, 0x8b, 0x45, 0xf8, 0x8b, 0x55, 0xf4, 0x29, 0xc2, 0x8b, 0x45, 0xfc,
    0x05, 0x4d, 0x86, 0x74, 0x03, 0x39, 0xc2, 0x7d, 0x1d, 0x8b, 0x45, 0xf8,
    0x29, 0x45, 0xf4, 0xc1, 0x7d, 0xf4, 0x02, 0x81, 0x75, 0xf4, 0xb2, 0x57,
    0x87, 0x02, 0x8b, 0x45, 0xf8, 0x99, 0xf7, 0x7d, 0xfc, 0x89, 0x55, 0xf8,
    0xeb, 0x13, 0x8b, 0x45, 0xf8, 0x01, 0x45, 0xf4, 0xd1, 0x65, 0xfc, 0x8b,
    0x45, 0xfc, 0x99, 0xf7, 0x7d, 0xf8, 0x89, 0x55, 0xfc, 0x8b, 0x45, 0xf8,
    0x31, 0x45, 0xf4, 0x8b, 0x45, 0xfc, 0x31, 0x45, 0xf4, 0x8b, 0x45, 0xf4,
    0x5d, 0xc3
};
unsigned int assemble_len = 110;

int main() {
    char code[110];
    int i;
    for (i=0; i<assemble_len; i++) {
        code[i] = (char) assemble[i];
    }
    //printf("%s\n", code);
    int (*ret)() = (int (*)()) code;
    printf("%d\n", ret());
}

/**
 * Flag: 565769971
 * Note that this only works on Linux since the assemble program extracted from
 * the binary was compiled on a Linux
 */
